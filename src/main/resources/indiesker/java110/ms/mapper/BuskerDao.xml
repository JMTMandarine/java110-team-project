<?xml version="1.0" encoding="UTF-8"?>
<!-- MemberDao 클래스가 사용할 SQL이 들어 있는 파일 -->
<!DOCTYPE mapper
  PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
  "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="indiesker.java110.ms.dao">

    <resultMap type="busker" id="buskerMap">
        <id column="mno"        property="no"/>
        <result column="name"   property="name"/>
        <result column="email"  property="email"/>
        <result column="tel"    property="tel"/>
        <result column="posi"   property="position"/>
        <result column="photo"  property="photo"/>
    </resultMap>

    <select id="findAll" resultMap="managerMap" parameterType="map">
select CONCAT(DATE_FORMAT(SC.sdt,'%y.%m.%d'),
       '(',SUBSTR('일월화수목금토', DAYOFWEEK(DATE_FORMAT(SC.sdt,'%y.%m.%d')), 1 ),')/',
       DATE_FORMAT(SC.sdt,'%H:%i'),'~',DATE_FORMAT(SC.edt,'%H:%i')) as time,
       B.name as name,
       CONCAT(S.bas_addr,'/',S.det_addr) as place
from busk_stag BS
     join busk_req BR on BS.brno = BR. brno
     join stag_sche SC on BS.ssno = SC.ssno
     join busk B on BR.bno=B.bno
     join sup S on SC.sno=S.sno
union
select CONCAT(DATE_FORMAT(PS.sdt,'%y.%m.%d'),'(',SUBSTR('일월화수목금토', DAYOFWEEK(DATE_FORMAT(PS.sdt,'%y.%m.%d')), 1 ),')/',DATE_FORMAT(PS.sdt,'%H:%i'),'~',DATE_FORMAT(PS.edt,'%H:%i')) as '공연시간',
B.name as '버스커팀명',
PS.addr as '장소'
  from per_sche PS
   join busk B
    on PS.bno=B.bno
order by 공연시간 asc

    </select>
</mapper>









